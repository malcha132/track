<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Income Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%); }
        .table-xs td, .table-xs th { padding: 0.5rem 0.75rem; font-size: 0.875rem; }
    </style>
</head>
<body class="min-h-screen text-gray-100 p-2 md:p-6">
    <div class="max-w-6xl mx-auto">
        <header class="text-center mb-6">
            <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-green-400 to-green-600 bg-clip-text text-transparent mb-1">
                üé∞ Poker Tracker
            </h1>
            <p class="text-xs text-gray-400">Your bankroll</p>
        </header>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 mb-6">
            <div class="bg-gradient-to-br from-green-600/20 to-green-700/20 border border-green-500/30 rounded-lg p-4 shadow-lg">
                <div class="text-green-400 text-xs uppercase tracking-wider mb-1 font-semibold">Celkov√Ω Profit</div>
                <div id="totalProfit" class="text-2xl font-bold">0 Kƒç</div>
            </div>
            <div class="bg-gray-800/50 border border-gray-700 rounded-lg p-4 shadow-lg">
                <div class="text-gray-400 text-xs uppercase tracking-wider mb-1 font-semibold">ROI</div>
                <div id="roi" class="text-2xl font-bold text-gray-100">0%</div>
            </div>
            <div class="bg-gray-800/50 border border-gray-700 rounded-lg p-4 shadow-lg">
                <div class="text-gray-400 text-xs uppercase tracking-wider mb-1 font-semibold">Hodinov√Ω v√Ωdƒõlek</div>
                <div id="hourlyRate" class="text-2xl font-bold text-gray-100">0 Kƒç/h</div>
            </div>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-lg shadow-xl p-4 mb-6">
            <h2 class="text-lg font-bold mb-4 text-green-400 flex items-center">‚ûï <span class="ml-2">Nov√° session</span></h2>
            <form id="sessionForm" class="grid grid-cols-2 md:grid-cols-6 gap-3 items-end">
                <div class="col-span-2 md:col-span-1">
                    <label class="block text-xs font-medium mb-1 text-gray-400">Datum</label>
                    <input type="date" id="date" required class="w-full px-3 py-1.5 bg-gray-900 border border-gray-600 rounded text-sm focus:ring-1 focus:ring-green-500 outline-none">
                </div>
                <div class="col-span-2 md:col-span-1">
                    <label class="block text-xs font-medium mb-1 text-gray-400">Hra</label>
                    <select id="game" required class="w-full px-3 py-1.5 bg-gray-900 border border-gray-600 rounded text-sm focus:ring-1 focus:ring-green-500 outline-none">
                        <option value="NL Hold'em">NL Hold'em</option>
                        <option value="PLO">PLO</option>
                        <option value="Tournament">MTT</option>
                        <option value="Sit & Go">SNG</option>
                    </select>
                </div>
                <div>
                    <label class="block text-xs font-medium mb-1 text-gray-400">Buy-in</label>
                    <input type="number" id="buyin" required min="0" class="w-full px-3 py-1.5 bg-gray-900 border border-gray-600 rounded text-sm focus:ring-1 focus:ring-green-500 outline-none" placeholder="Kƒç">
                </div>
                <div>
                    <label class="block text-xs font-medium mb-1 text-gray-400">Cashout</label>
                    <input type="number" id="cashout" required min="0" class="w-full px-3 py-1.5 bg-gray-900 border border-gray-600 rounded text-sm focus:ring-1 focus:ring-green-500 outline-none" placeholder="Kƒç">
                </div>
                <div>
                    <label class="block text-xs font-medium mb-1 text-gray-400">ƒåas (h)</label>
                    <input type="number" id="hours" required min="0.1" step="0.1" class="w-full px-3 py-1.5 bg-gray-900 border border-gray-600 rounded text-sm focus:ring-1 focus:ring-green-500 outline-none" placeholder="h">
                </div>
                <div class="col-span-2 md:col-span-1">
                    <button type="submit" class="w-full py-2 bg-green-600 hover:bg-green-500 text-white text-sm font-bold rounded shadow-md transition-all active:scale-95">
                        ULO≈ΩIT
                    </button>
                </div>
            </form>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-lg shadow-xl overflow-hidden mb-6">
            <div class="px-4 py-3 border-b border-gray-700 flex justify-between items-center bg-gray-800/50">
                <h2 class="font-bold text-green-400 uppercase text-sm tracking-widest">Historie</h2>
                <button id="clearAll" class="text-xs text-gray-500 hover:text-red-400 transition-colors">
                    Smazat v≈°e
                </button>
            </div>
            <div class="overflow-x-auto">
                <table class="w-full table-xs">
                    <thead class="bg-gray-900/50 text-gray-400 border-b border-gray-700">
                        <tr>
                            <th class="text-left">Datum</th>
                            <th class="text-left">Hra</th>
                            <th class="text-right">Buy-in</th>
                            <th class="text-right">Cashout</th>
                            <th class="text-right">Profit</th>
                            <th class="text-right">Hodinov√°</th>
                            <th class="text-center">Akce</th>
                        </tr>
                    </thead>
                    <tbody id="sessionsTable" class="divide-y divide-gray-700/50">
                    </tbody>
                </table>
                <div id="emptyState" class="text-center py-8 text-gray-600 hidden">
                    <p class="text-sm italic">≈Ω√°dn√© z√°znamy k zobrazen√≠</p>
                </div>
            </div>
        </div>

        <div class="bg-gray-800 border border-gray-700 rounded-lg shadow-xl p-4">
            <h2 class="font-bold text-green-400 uppercase text-sm tracking-widest mb-4 text-center">V√Ωvoj Bankrollu</h2>
            <div class="relative w-full h-64">
                <canvas id="profitChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        let sessions = JSON.parse(localStorage.getItem('pokerSessions')) || [];
        let profitChart = null; // Instance grafu

        document.getElementById('date').valueAsDate = new Date();

        document.getElementById('sessionForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const session = {
                id: Date.now(),
                date: document.getElementById('date').value,
                game: document.getElementById('game').value,
                buyin: parseFloat(document.getElementById('buyin').value),
                cashout: parseFloat(document.getElementById('cashout').value),
                hours: parseFloat(document.getElementById('hours').value)
            };
            sessions.push(session);
            saveAndRender();
            this.reset();
            document.getElementById('date').valueAsDate = new Date();
        });

        function saveAndRender() {
            localStorage.setItem('pokerSessions', JSON.stringify(sessions));
            renderSessions();
            updateStatistics();
            updateChart();
        }

        function renderSessions() {
            const tbody = document.getElementById('sessionsTable');
            const emptyState = document.getElementById('emptyState');
            
            if (sessions.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            emptyState.classList.add('hidden');

            const sorted = [...sessions].sort((a, b) => new Date(b.date) - new Date(a.date));
            tbody.innerHTML = sorted.map(s => {
                const profit = s.cashout - s.buyin;
                const hRate = s.hours > 0 ? (profit / s.hours) : 0;
                const profitClass = profit >= 0 ? 'text-green-400' : 'text-red-400';
                
                return `
                    <tr class="hover:bg-gray-700/30 transition-colors">
                        <td class="text-gray-400">${formatDate(s.date)}</td>
                        <td class="font-medium">${s.game}</td>
                        <td class="text-right">${formatNum(s.buyin)}</td>
                        <td class="text-right">${formatNum(s.cashout)}</td>
                        <td class="text-right font-bold ${profitClass}">${profit > 0 ? '+' : ''}${formatNum(profit)}</td>
                        <td class="text-right text-xs ${profitClass}">${formatNum(hRate)}/h</td>
                        <td class="text-center">
                            <button onclick="deleteSession(${s.id})" class="text-gray-500 hover:text-red-500 p-1">‚úï</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function updateStatistics() {
            const tin = sessions.reduce((s, x) => s + x.buyin, 0);
            const tout = sessions.reduce((s, x) => s + x.cashout, 0);
            const thrs = sessions.reduce((s, x) => s + x.hours, 0);
            const profit = tout - tin;
            
            document.getElementById('totalProfit').textContent = `${profit >= 0 ? '+' : ''}${formatNum(profit)} Kƒç`;
            document.getElementById('totalProfit').className = `text-2xl font-bold ${profit >= 0 ? 'text-green-500' : 'text-red-500'}`;
            document.getElementById('roi').textContent = tin > 0 ? ((profit / tin) * 100).toFixed(1) + '%' : '0%';
            document.getElementById('hourlyRate').textContent = thrs > 0 ? formatNum(profit / thrs) + ' Kƒç/h' : '0 Kƒç/h';
        }

        function updateChart() {
            const ctx = document.getElementById('profitChart').getContext('2d');
            
            // Se≈ôazen√≠ chronologicky pro graf
            const chronologicalSessions = [...sessions].sort((a, b) => new Date(a.date) - new Date(b.date));
            
            let currentSum = 0;
            const dataPoints = chronologicalSessions.map(s => {
                currentSum += (s.cashout - s.buyin);
                return { x: formatDate(s.date), y: currentSum };
            });

            if (profitChart) {
                profitChart.destroy();
            }

            profitChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: dataPoints.map(p => p.x),
                    datasets: [{
                        label: 'Bankroll (Kƒç)',
                        data: dataPoints.map(p => p.y),
                        borderColor: '#10b981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        fill: true,
                        tension: 0.3,
                        pointBackgroundColor: '#10b981',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        x: {
                            ticks: { color: '#9ca3af', font: { size: 10 } },
                            grid: { display: false }
                        },
                        y: {
                            ticks: { color: '#9ca3af', font: { size: 10 } },
                            grid: { color: 'rgba(156, 163, 175, 0.1)' }
                        }
                    }
                }
            });
        }

        function deleteSession(id) {
            if(confirm('Smazat?')) {
                sessions = sessions.filter(s => s.id !== id);
                saveAndRender();
            }
        }

        document.getElementById('clearAll').addEventListener('click', () => {
            if(confirm('Smazat v≈°e?')) { sessions = []; saveAndRender(); }
        });

        function formatNum(n) { return Math.round(n).toLocaleString('cs-CZ'); }
        function formatDate(d) { return new Date(d).toLocaleDateString('cs-CZ', {day:'2-digit', month:'2-digit'}); }

        // Inicializace
        renderSessions();
        updateStatistics();
        updateChart();
    </script>
</body>

</html>

